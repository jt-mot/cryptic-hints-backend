<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Import Puzzle 29915</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 3rem;
            max-width: 600px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
        }

        h1 {
            color: #333;
            margin-bottom: 0.5rem;
            font-size: 2rem;
        }

        .subtitle {
            color: #666;
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .info-box {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            text-align: left;
        }

        .info-box h3 {
            color: #667eea;
            margin-bottom: 1rem;
        }

        .info-box ul {
            list-style: none;
            line-height: 2;
        }

        .info-box li:before {
            content: "‚úì ";
            color: #667eea;
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1.25rem 3rem;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .result {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: 12px;
            display: none;
        }

        .result.success {
            background: #d4edda;
            color: #155724;
        }

        .result.error {
            background: #f8d7da;
            color: #721c24;
        }

        .loading {
            display: none;
            margin-top: 1rem;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .link-btn {
            display: inline-block;
            margin-top: 1rem;
            padding: 0.75rem 2rem;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
        }

        .link-btn:hover {
            background: #764ba2;
        }
    </style>
</head>
<body>
    <div class="card">
        <h1>üéØ Import Puzzle 29915</h1>
        <p class="subtitle">Guardian Cryptic by Qaos</p>

        <div class="info-box">
            <h3>What will be imported:</h3>
            <ul>
                <li>33 clues (15 across, 18 down)</li>
                <li>All answers and enumerations</li>
                <li>4 levels of hints per clue</li>
                <li>Puzzle metadata (setter, date)</li>
            </ul>
        </div>

        <button class="btn" onclick="importPuzzle()" id="importBtn">
            Click to Import Puzzle 29915
        </button>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p style="margin-top: 1rem; color: #666;">Importing puzzle...</p>
        </div>

        <div id="result" class="result"></div>
    </div>

    <script>
        const puzzleData = {
            "publication": "Guardian",
            "puzzle_number": "29915",
            "setter": "Qaos",
            "date": "2026-01-28",
            "clues": [
                {"clue_number": 9, "direction": "across", "clue_text": "Look into firm's capital", "enumeration": "5", "answer": "CAIRO", "hints": ["Definition: capital. Wordplay: AIR (look) inside CO (firm)", "The answer is an African capital city", "C + AIR in CO = CAIRO", "AIR (look) goes inside CO (company/firm) to give CAIRO (capital of Egypt)"]},
                {"clue_number": 10, "direction": "across", "clue_text": "'Increase risk from chopped peanut' ‚Äì inspiring article", "enumeration": "2,3,4", "answer": "UP THE ANTE", "hints": ["Definition: increase risk. Anagram indicator: 'chopped'", "Anagram of PEANUT around THE (article)", "Chopped PEANUT containing THE", "UP THE ANTE is an anagram of PEANUT around THE (article)"]},
                {"clue_number": 11, "direction": "across", "clue_text": "Record bird circling me ‚Äì it won't last long", "enumeration": "9", "answer": "EPHEMERON", "hints": ["Definition: it won't last long. EP = record, HERON = bird", "Something short-lived, singular of ephemera", "EP + HERON around ME", "EP (record) + HERON (bird) circling ME = EPHEMERON (something short-lived)"]},
                {"clue_number": 12, "direction": "across", "clue_text": "In Polish, 'time' means 'resistance'", "enumeration": "5", "answer": "STAND", "hints": ["Definition: resistance. Polish = SAND, T = time", "Put T (time) inside SAND (polish)", "S + T + AND", "T (time) inside SAND (polish) = STAND (resistance/withstand)"]},
                {"clue_number": 13, "direction": "across", "clue_text": "Perhaps the Sun let being hacked shock", "enumeration": "7", "answer": "STARTLE", "hints": ["Definition: shock. STAR = perhaps the sun, anagram of LET", "STAR + anagram of LET", "STAR + (LET anagram)", "STAR (perhaps the sun) + anagram of LET (hacked) = STARTLE (shock)"]},
                {"clue_number": 15, "direction": "across", "clue_text": "Dagger, not a dessert, smuggled into prison", "enumeration": "7", "answer": "STICKER", "hints": ["Definition: dagger. CAKE (dessert) without A, inside STIR (prison)", "CKE inside STIR", "ST + CKE + R", "CAKE (dessert) minus A inside STIR (prison) = STICKER (dagger/knife)"]},
                {"clue_number": 17, "direction": "across", "clue_text": "Car with one wheel ‚Äì sound?", "enumeration": "5", "answer": "AUDIO", "hints": ["Definition: sound. AUDI (car) + O (one/wheel)", "A car brand plus O", "AUDI + O", "AUDI (car) + O (one/wheel) = AUDIO (sound)"]},
                {"clue_number": 18, "direction": "across", "clue_text": "Firm sofa 50% off", "enumeration": "3", "answer": "SET", "hints": ["Definition: firm. Half of SETTEE (sofa)", "First 50% of a word for sofa", "First half of SETTEE", "SETTEE (sofa) 50% off = SET (firm/solid)"]},
                {"clue_number": 20, "direction": "across", "clue_text": "Punches produce shiners", "enumeration": "5", "answer": "LAMPS", "hints": ["Double definition: punches and shiners (lights)", "Both meanings relate to hitting and lighting", "Think of black eyes (shiners) and lights", "LAMPS = punches (hits) and shiners (lights/black eyes)"]},
                {"clue_number": 22, "direction": "across", "clue_text": "Clasp them briefly with heaving moobs", "enumeration": "7", "answer": "EMBOSOM", "hints": ["Definition: clasp. 'EM (them briefly) + anagram of MOOBS", "Abbreviation of 'them' + anagram", "'EM + BOSOM", "'EM (them briefly) + anagram of MOOBS (heaving) = EMBOSOM (clasp/hug)"]},
                {"clue_number": 25, "direction": "across", "clue_text": "Helps donkey get first and second", "enumeration": "7", "answer": "ASSISTS", "hints": ["Definition: helps. ASS = donkey, IST = first, S = second", "ASS + 1ST + S", "Donkey + abbreviation for first + S", "ASS (donkey) + IST (first) + S (second) = ASSISTS (helps)"]},
                {"clue_number": 26, "direction": "across", "clue_text": "Ship to remain without any goods", "enumeration": "5", "answer": "LINER", "hints": ["Definition: ship. LINGER (remain) without G (goods)", "Remove G from a word meaning 'remain'", "LINGER - G", "LINGER (remain) without G (goods) = LINER (ship)"]},
                {"clue_number": 27, "direction": "across", "clue_text": "Must elder play this instrument?", "enumeration": "5,4", "answer": "STEEL DRUM", "hints": ["Definition: instrument. Anagram of MUST ELDER", "Anagram indicator: 'play'", "Anagram of all the letters", "Anagram of MUST ELDER (play) = STEEL DRUM (instrument)"]},
                {"clue_number": 30, "direction": "across", "clue_text": "Not half clever getting solutions without soap?", "enumeration": "9", "answer": "CLEANSERS", "hints": ["Definition: soap. CLE (half of clever) + ANSWERS without W", "First half of CLEVER + ANSWERS without W (with)", "CLE + ANSERS", "CLEVER not half (CLE) + ANSWERS without W (with) = CLEANSERS (soap)"]},
                {"clue_number": 31, "direction": "across", "clue_text": "Examples of luggage", "enumeration": "5", "answer": "CASES", "hints": ["Double definition", "CASES can mean examples or luggage", "Think of legal cases and suitcases", "CASES = examples (legal cases) and luggage (suitcases)"]},
                {"clue_number": 1, "direction": "down", "clue_text": "Companion enters hospital department in pain", "enumeration": "4", "answer": "ACHE", "hints": ["Definition: pain. CH (Companion of Honour) inside A&E (hospital department)", "A + CH + E", "Hospital abbreviation with CH inside", "CH (Companion) inside A&E (hospital department) = ACHE (pain)"]},
                {"clue_number": 2, "direction": "down", "clue_text": "Trip to arrive in mountainous area", "enumeration": "8", "answer": "HIGHLAND", "hints": ["Definition: mountainous area. HIGH = trip, LAND = arrive", "HIGH + LAND", "Drug slang + to arrive", "HIGH (trip/drug high) + LAND (arrive) = HIGHLAND (mountainous area)"]},
                {"clue_number": 3, "direction": "down", "clue_text": "Ring in memory of 13 down", "enumeration": "4", "answer": "ROOM", "hints": ["Definition: reference to 13D (SPACE). O (ring) inside ROM (memory)", "Computer memory term with O inside", "R + O + OM", "O (ring) inside ROM (memory) = ROOM (space)"]},
                {"clue_number": 4, "direction": "down", "clue_text": "3 + 3 + 3 = 1/4 + 1/4 +1/4?", "enumeration": "8", "answer": "QUARTERS", "hints": ["Mathematical wordplay: 3 ROOMs = ROOMS = QUARTERS", "Three quarters = three 1/4s", "ROOM + ROOM + ROOM = QUARTERS", "Three of 3D (ROOM) = ROOMS = QUARTERS (three 1/4s)"]},
                {"clue_number": 5, "direction": "down", "clue_text": "Last one standing carries lots of weight", "enumeration": "6", "answer": "STONES", "hints": ["Definition: weight. Hidden in 'last one standing'", "Hidden word indicator: 'carries'", "Look in 'laST ONE Standing'", "Hidden in 'laST ONE Standing' = STONES (weight measurement)"]},
                {"clue_number": 6, "direction": "down", "clue_text": "Silver seal broken in palace", "enumeration": "10", "answer": "VERSAILLES", "hints": ["Definition: palace. Anagram of SILVER SEAL", "Anagram indicator: 'broken'", "All letters rearranged", "Anagram of SILVER SEAL (broken) = VERSAILLES (palace in France)"]},
                {"clue_number": 7, "direction": "down", "clue_text": "Expose country defending man's rambling", "enumeration": "6", "answer": "UNMASK", "hints": ["Definition: expose. UK (country) around anagram of MAN'S", "UK containing scrambled MAN'S", "U + NMAS + K", "UK (country) defending anagram of MAN'S (rambling) = UNMASK (expose)"]},
                {"clue_number": 8, "direction": "down", "clue_text": "Discovering they made leader", "enumeration": "4", "answer": "HEAD", "hints": ["Definition: leader. Remove outer letters from THEY and MADE", "'Discovering' means remove covers/outer letters", "HE + AD (middle letters)", "Discovering (uncovering) THEY and MADE = HE + AD = HEAD (leader)"]},
                {"clue_number": 13, "direction": "down", "clue_text": "Well, church builds no character", "enumeration": "5", "answer": "SPACE", "hints": ["Definition: no character (as on keyboard). SPA = well, CE = church", "SPA + CE", "Health resort + church abbreviation", "SPA (well/spa) + CE (church) = SPACE (no character on keyboard)"]},
                {"clue_number": 14, "direction": "down", "clue_text": "Stealing fancy store jewellery ‚Äì you involved?", "enumeration": "10", "answer": "TROUSERING", "hints": ["Definition: stealing. U (you) inside anagram of STORE + RING", "Anagram indicator: 'fancy'", "U inside (STORE + RING) anagram", "U (you) involved in anagram of STORE RING (fancy) = TROUSERING (stealing/pocketing)"]},
                {"clue_number": 16, "direction": "down", "clue_text": "Soundly twists snooker equipment", "enumeration": "5", "answer": "RESTS", "hints": ["Definition: snooker equipment. Homophone of WRESTS (twists)", "Sounds like 'wrests'", "Homophone indicator: 'soundly'", "Sounds like WRESTS (twists) = RESTS (snooker equipment)"]},
                {"clue_number": 19, "direction": "down", "clue_text": "VAR rewound during short cross", "enumeration": "8", "answer": "TRAVERSE", "hints": ["Definition: cross. VAR reversed inside TERSE (short)", "RAV inside TERSE", "T + RAV + ERSE", "VAR rewound (reversed) during TERSE (short) = TRAVERSE (cross)"]},
                {"clue_number": 21, "direction": "down", "clue_text": "Film on extremely serious Lady Hamilton?", "enumeration": "8", "answer": "MISTRESS", "hints": ["Definition: Lady Hamilton (Nelson's mistress). MIST = film, RE = on, S...S = extremely serious", "MIST + RE + outer letters of serious", "MIST + RE + SS", "MIST (film) + RE (on) + S...S (extremely serious) = MISTRESS (Lady Hamilton)"]},
                {"clue_number": 23, "direction": "down", "clue_text": "Don't allow mirrored license plate with old car", "enumeration": "6", "answer": "BANGER", "hints": ["Definition: old car. BAN = don't allow, REG (license plate) reversed", "BAN + GER (REG backwards)", "BAN + mirrored REG", "BAN (don't allow) + REG (license plate) mirrored = BANGER (old car)"]},
                {"clue_number": 24, "direction": "down", "clue_text": "Ruler quicker to change gender?", "enumeration": "6", "answer": "MASTER", "hints": ["Definition: ruler. FASTER (quicker) with F changed to M (gender change)", "Change F (female) to M (male) in FASTER", "M replacing F in FASTER", "FASTER (quicker) changing gender F‚ÜíM = MASTER (ruler)"]},
                {"clue_number": 26, "direction": "down", "clue_text": "Cops missing work over bugs", "enumeration": "4", "answer": "LICE", "hints": ["Definition: bugs. POLICE (cops) minus OP (work) reversed", "Remove OP from POLICE and reverse", "LICE backwards from POLICE", "POLICE (cops) missing OP (work) over (reversed) = LICE (bugs)"]},
                {"clue_number": 28, "direction": "down", "clue_text": "South of the border, we're told lake is secure", "enumeration": "4", "answer": "LOCK", "hints": ["Definition: secure. Homophone of LOCH (lake)", "Sounds like Scottish word for lake", "Homophone indicator: 'we're told'", "LOCH (lake) sounds like LOCK (secure) south of Scottish border"]},
                {"clue_number": 29, "direction": "down", "clue_text": "Plant grasses someone up inside", "enumeration": "4", "answer": "MOSS", "hints": ["Definition: plant. Hidden reversed in 'grasses someone'", "Hidden word indicator: 'inside', reversal: 'up'", "Look in 'grasseS SOMeone' backwards", "Hidden reversed in 'grasseS SOMeone' (up/inside) = MOSS (plant)"]}
            ]
        };

        async function importPuzzle() {
            const btn = document.getElementById('importBtn');
            const loading = document.getElementById('loading');
            const resultDiv = document.getElementById('result');

            // Disable button and show loading
            btn.disabled = true;
            loading.style.display = 'block';
            resultDiv.style.display = 'none';

            try {
                console.log('Sending puzzle data:', puzzleData);
                
                const response = await fetch('/admin/api/import-puzzle', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    credentials: 'same-origin',
                    body: JSON.stringify(puzzleData)
                });

                console.log('Response status:', response.status);
                console.log('Response headers:', response.headers);
                
                // Get the response as text first to see what we're getting
                const responseText = await response.text();
                console.log('Raw response:', responseText);
                
                loading.style.display = 'none';

                // Try to parse as JSON
                let result;
                try {
                    result = JSON.parse(responseText);
                } catch (e) {
                    // If it's not JSON, it might be HTML (redirect to login)
                    if (responseText.includes('login') || responseText.includes('<html>')) {
                        resultDiv.className = 'result error';
                        resultDiv.style.display = 'block';
                        resultDiv.innerHTML = `
                            <h3>‚ùå Authentication Error</h3>
                            <p>You need to be logged in to import puzzles.</p>
                            <p>Please <a href="/admin/login">login first</a>, then try again.</p>
                        `;
                        btn.disabled = false;
                        return;
                    }
                    throw new Error('Server returned invalid response: ' + responseText.substring(0, 200));
                }

                if (response.ok) {
                    resultDiv.className = 'result success';
                    resultDiv.style.display = 'block';
                    resultDiv.innerHTML = `
                        <h2>‚úÖ Success!</h2>
                        <p style="font-size: 1.1rem; margin: 1rem 0;">
                            Puzzle #29915 imported successfully!
                        </p>
                        <p><strong>Puzzle ID:</strong> ${result.puzzle_id}</p>
                        <p><strong>Clues imported:</strong> ${puzzleData.clues.length}</p>
                        <a href="/admin/review" class="link-btn">
                            Go to Admin Review ‚Üí
                        </a>
                    `;
                } else {
                    throw new Error(result.error || 'Import failed');
                }

            } catch (error) {
                loading.style.display = 'none';
                resultDiv.className = 'result error';
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h3>‚ùå Error</h3>
                    <p>${error.message}</p>
                    <p style="margin-top: 1rem; font-size: 0.9rem; color: #666;">
                        Check browser console (F12) for more details.
                    </p>
                `;
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
